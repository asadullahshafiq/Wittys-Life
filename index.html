<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="theme-color" content="#0d1117">
<meta name="description" content="Replace Deeds - Premium Habit Tracker">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icons/icon-192.png">
<title>Replace Deeds</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<!-- SPLASH SCREEN -->
<div id="splash" class="splash">
  <div class="splash-logo">
    <div class="logo-ring">
      <svg viewBox="0 0 100 100" class="logo-svg">
        <circle cx="50" cy="50" r="40" fill="none" stroke="rgba(0,212,180,0.3)" stroke-width="3"/>
        <path d="M50 15 A35 35 0 1 1 15 50" fill="none" stroke="#00d4b4" stroke-width="3" stroke-linecap="round"/>
        <polygon points="48,8 56,18 40,18" fill="#00d4b4"/>
        <polyline points="30,52 44,66 72,38" fill="none" stroke="#00d4b4" stroke-width="5" stroke-linecap="round" stroke-linejoin="round" class="logo-check"/>
      </svg>
    </div>
    <h1 class="splash-title">Replace Deeds</h1>
    <p class="splash-sub">Build. Sustain. Transform.</p>
  </div>
</div>

<!-- ONBOARDING -->
<div id="onboarding" class="screen hidden">
  <div class="onboard-container">
    <div class="onboard-step active" data-step="0">
      <div class="onboard-icon">ğŸŒ±</div>
      <h2>Welcome to Replace Deeds</h2>
      <p>A premium habit tracker that grows with you. Plant your tree of consistency.</p>
      <button class="btn-primary" onclick="nextOnboard()">Let's Begin</button>
    </div>
    <div class="onboard-step" data-step="1">
      <div class="onboard-icon">ğŸ‘¤</div>
      <h2>Create Your Profile</h2>
      <div class="field-group">
        <label>Full Name *</label>
        <input type="text" id="pName" placeholder="Your name">
      </div>
      <div class="field-group">
        <label>Father's Name</label>
        <input type="text" id="pFather" placeholder="Father's name">
      </div>
      <div class="field-group">
        <label>Date of Birth *</label>
        <input type="date" id="pDOB">
      </div>
      <div class="field-group">
        <label>Username *</label>
        <input type="text" id="pUsername" placeholder="@username">
      </div>
      <div class="field-group">
        <label>PIN (4 digits) *</label>
        <input type="password" id="pPin" maxlength="4" placeholder="â€¢â€¢â€¢â€¢" inputmode="numeric">
      </div>
      <button class="btn-primary" onclick="saveProfile()">Create Profile</button>
    </div>
    <div class="onboard-step" data-step="2">
      <div class="onboard-icon">ğŸ¯</div>
      <h2>Make a Commitment</h2>
      <p>How long are you committing to Replace Deeds?</p>
      <div class="commit-options">
        <button class="commit-btn" data-days="7">7 Days</button>
        <button class="commit-btn" data-days="20">20 Days</button>
        <button class="commit-btn" data-days="50">50 Days</button>
        <button class="commit-btn" data-days="100">100 Days</button>
        <button class="commit-btn" data-days="365">365 Days ğŸ†</button>
      </div>
      <button class="btn-primary" onclick="finishOnboard()" id="commitNext" disabled>Start Journey</button>
    </div>
  </div>
</div>

<!-- MAIN APP -->
<div id="app" class="screen hidden">

  <!-- TOP BAR -->
  <header class="topbar">
    <div class="topbar-left">
      <div class="streak-badge" id="streakBadge" onclick="showStreakInfo()">
        <span class="streak-fire">ğŸ”¥</span>
        <span class="streak-num" id="streakNum">0</span>
      </div>
    </div>
    <div class="topbar-center">
      <svg viewBox="0 0 40 40" width="28" height="28" style="cursor:pointer" onclick="showTab('result')">
        <circle cx="20" cy="20" r="16" fill="none" stroke="rgba(0,212,180,0.4)" stroke-width="2"/>
        <path d="M20 6 A14 14 0 1 1 6 20" fill="none" stroke="#00d4b4" stroke-width="2" stroke-linecap="round"/>
        <polygon points="19,2 23,8 15,8" fill="#00d4b4"/>
        <polyline points="12,21 17,27 29,15" fill="none" stroke="#00d4b4" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <div class="topbar-right">
      <div class="water-badge" onclick="showTab('result')">
        <span>ğŸ’§</span>
        <span id="totalWater">0</span>
      </div>
      <div class="avatar-btn" onclick="showTab('settings')">
        <span id="avatarInitial">U</span>
      </div>
    </div>
  </header>

  <!-- MOTIVATION BANNER -->
  <div class="motivation-banner">
    <span id="motivText">Every great journey begins with a single step ğŸŒŸ</span>
  </div>

  <!-- MAIN CONTENT -->
  <main class="main-content">

    <!-- HABITS TAB -->
    <div class="tab-panel active" id="tab-habits">
      <div class="sections-container" id="sectionsContainer"></div>
      <button class="fab-add" onclick="showAddSection()" title="Add Section">+</button>
    </div>

    <!-- TASKS TAB -->
    <div class="tab-panel" id="tab-tasks">
      <div class="tasks-header">
        <h2>Tasks</h2>
        <button class="btn-icon" onclick="showAddTask()">+</button>
      </div>
      <div class="tasks-list" id="tasksList"></div>
      <div class="tasks-empty" id="tasksEmpty"><p>No tasks yet.<br>Tap + to add your first task!</p></div>
    </div>

    <!-- ANALYTICS TAB -->
    <div class="tab-panel" id="tab-analytics">
      <div class="analytics-header"><h2>Analytics</h2></div>
      <div class="analytics-grid" id="analyticsGrid"></div>
    </div>

    <!-- RESULT TAB -->
    <div class="tab-panel" id="tab-result">
      <div class="result-header">
        <h2>Your Tree</h2>
        <div class="result-stats">
          <span id="resultDays">Day 0</span>
          <span id="resultMedal">ğŸªµ Wood</span>
        </div>
      </div>
      <div class="tree-container">
        <canvas id="treeCanvas" width="320" height="320"></canvas>
      </div>
      <div class="water-info">
        <div class="water-stat">
          <span class="water-label">ğŸ’§ Total Water</span>
          <span class="water-val" id="totalWaterResult">0 gallons</span>
        </div>
        <div class="water-stat">
          <span class="water-label">ğŸŒ¿ Tree Stage</span>
          <span class="water-val" id="treeStage">Seed</span>
        </div>
      </div>
      <div class="grass-grid" id="grassGrid"></div>
    </div>

    <!-- SETTINGS TAB -->
    <div class="tab-panel" id="tab-settings">
      <div class="settings-container">
        <h2>Settings</h2>
        <div class="settings-section">
          <h3>Profile</h3>
          <div class="profile-card" id="profileCard"></div>
        </div>
        <div class="settings-section">
          <h3>Theme</h3>
          <div class="theme-options">
            <button class="theme-btn active" data-theme="dark"   onclick="setTheme('dark')">ğŸŒ™ Dark</button>
            <button class="theme-btn"        data-theme="ocean"  onclick="setTheme('ocean')">ğŸŒŠ Ocean</button>
            <button class="theme-btn"        data-theme="forest" onclick="setTheme('forest')">ğŸŒ¿ Forest</button>
            <button class="theme-btn"        data-theme="sunset" onclick="setTheme('sunset')">ğŸŒ… Sunset</button>
          </div>
        </div>
        <div class="settings-section">
          <h3>Streak Freeze</h3>
          <div class="freeze-status">
            <span id="freezeText">No freeze active</span>
            <button class="btn-secondary" onclick="useStreakFreeze()" id="freezeBtn">Use Freeze â„ï¸</button>
          </div>
        </div>
        <div class="settings-section danger-zone">
          <h3>Data</h3>
          <button class="btn-danger" onclick="exportData()">ğŸ“¤ Export Data</button>
          <button class="btn-danger" onclick="confirmReset()">ğŸ—‘ï¸ Reset App</button>
        </div>
      </div>
    </div>

  </main>

  <!-- BOTTOM NAV -->
  <nav class="bottom-nav">
    <button class="nav-btn active" onclick="showTab('habits')"   data-tab="habits">
      <span class="nav-icon">ğŸ </span><span class="nav-label">Habits</span>
    </button>
    <button class="nav-btn" onclick="showTab('tasks')"    data-tab="tasks">
      <span class="nav-icon">âœ…</span><span class="nav-label">Tasks</span>
    </button>
    <button class="nav-btn" onclick="showTab('analytics')" data-tab="analytics">
      <span class="nav-icon">ğŸ“Š</span><span class="nav-label">Analytics</span>
    </button>
    <button class="nav-btn" onclick="showTab('result')"   data-tab="result">
      <span class="nav-icon">ğŸŒ³</span><span class="nav-label">Result</span>
    </button>
    <button class="nav-btn" onclick="showTab('settings')" data-tab="settings">
      <span class="nav-icon">âš™ï¸</span><span class="nav-label">Settings</span>
    </button>
  </nav>
</div>

<!-- MODAL OVERLAY -->
<div id="modalOverlay" class="modal-overlay hidden" onclick="overlayClick(event)">
  <div class="modal" id="modalBox">
    <div class="modal-content" id="modalContent"></div>
  </div>
</div>

<!-- STREAK DIALOG -->
<div id="streakDialog" class="streak-dialog hidden">
  <div class="streak-dialog-inner">
    <div class="streak-dialog-icon" id="streakDialogIcon">âš ï¸</div>
    <h3 id="streakDialogTitle">Streak Warning!</h3>
    <p id="streakDialogMsg"></p>
    <div class="streak-dialog-btns" id="streakDialogBtns"></div>
  </div>
</div>

<!-- COMPLETION ANIMATION -->
<div id="completionAnim" class="completion-anim hidden">
  <div class="completion-inner">
    <div class="completion-text">Alhamdulillah! ğŸŒŸ</div>
    <div class="completion-msg" id="completionMsg"></div>
    <div class="water-drops" id="waterDrops"></div>
  </div>
</div>

<!-- BIRTHDAY MODAL -->
<div id="birthdayModal" class="birthday-modal hidden">
  <div class="birthday-inner">
    <div class="birthday-emoji">ğŸ‚</div>
    <h2>Happy Birthday!</h2>
    <p id="birthdayMsg"></p>
    <button class="btn-primary" onclick="document.getElementById('birthdayModal').classList.add('hidden')">Thank You! ğŸ‰</button>
  </div>
</div>

<script src="js/db.js"></script>
<script src="js/streak.js"></script>
<script src="js/tree.js"></script>
<script src="js/app.js"></script>
<script src="js/sw-register.js"></script>
</body>
</html>
